import{d as w,a as p,m as T,b as M,_ as k,o as i,c as n,e as t,t as a,w as g,v as V,r as b,F as f,f as A,g as $,n as D,h as v,i as y}from"./index-e4284eff.js";import{M as E}from"./modal-e715d6fb.js";import{u as L}from"./useLoadingStore-9d97ba22.js";import{u as q}from"./useToastMessageStore-735ffa67.js";import{T as B}from"./TheLoading-39dc63e8.js";const{VITE_API:m,VITE_API_PATH:_}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_API_PATH:"benson-vue3",BASE_URL:"/Vue3-training-2022-Winter/Week6-7/dist/",MODE:"production",DEV:!1,PROD:!0},{loadingState:d}=L(),{pushMessage:P}=q(),u=w("useProductStore",{state:()=>({modal:{},isShow:!1,products:[],product:{},loadingItem:""}),actions:{getProducts(){const o=`${m}/api/${_}/products/all`;d(!0),p.get(o).then(s=>{this.products=s.data.products,d(!1)}).catch(s=>{d(!1),P({style:"danger",title:"取得產品失敗",content:`${s.response.data.message}`})})},getProductDetail(o,s){this.getProduct(s),this.modal=o,this.isShow=!0,this.modal.openModal()},addToCart(o,s=1){const l=`${m}/api/${_}/cart`,h={product_id:o,qty:s};d(!0),p.post(l,{data:h}).then(()=>{d(!1),this.isShow&&(this.modal.closeModal(),this.isShow=!1,d(!1)),this.pushMessage({title:"已加入購物車"})}).catch(r=>{P({style:"danger",title:"加入購物車失敗，請稍後再試",content:`${r.response.data.message}`})})},getProduct(o){const s=`${m}/api/${_}/product/${o}`;d(!0),this.product={},p.get(s).then(l=>{this.product=l.data.product,d(!1)})}}}),U={data(){return{modal:{},qty:1}},mounted(){this.modal=new E(this.$refs.modal)},computed:{...T(u,["product"])},methods:{...M(u,["addToCart"]),openModal(){this.modal.show(),this.qty=1},closeModal(){this.modal.hide(),this.qty=1}}},N={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},z={class:"modal-dialog modal-xl",role:"document"},F={class:"modal-content border-0"},H={class:"modal-header bg-dark text-white"},O={class:"modal-title",id:"exampleModalLabel"},R=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),W={class:"modal-body"},j={class:"row"},G={class:"col-sm-6"},J=["src","alt"],K={class:"col-sm-6"},Q={class:"badge bg-primary rounded-pill"},X={key:0,class:"h5"},Y={key:1},Z={class:"h6"},x={class:"h5"},tt={class:"input-group"};function ot(o,s,l,h,r,C){return i(),n("div",N,[t("div",z,[t("div",F,[t("div",H,[t("h5",O,[t("span",null,a(o.product.title),1)]),R]),t("div",W,[t("div",j,[t("div",G,[t("img",{class:"img-fluid",src:o.product.imageUrl,alt:o.product.title},null,8,J)]),t("div",K,[t("span",Q,a(o.product.category),1),t("p",null,"商品描述："+a(o.product.description),1),t("p",null,"商品內容："+a(o.product.content),1),o.product.price===o.product.origin_price?(i(),n("div",X,a(o.product.price)+" 元 ",1)):(i(),n("div",Y,[t("del",Z,"原價 "+a(o.product.origin_price)+" 元",1),t("h5",x,"現在只要 "+a(o.product.price)+" 元",1)])),t("div",null,[t("div",tt,[g(t("input",{type:"number",class:"form-control",min:"1","onUpdate:modelValue":s[0]||(s[0]=c=>r.qty=c)},null,512),[[V,r.qty,void 0,{number:!0}]]),t("button",{type:"button",class:"btn btn-primary",onClick:s[1]||(s[1]=c=>o.addToCart(o.product.id))}," 加入購物車 ")])])])])])])])],512)}const st=k(U,[["render",ot]]),et={components:{ProductModal:st,TheLoading:B},computed:{...T(u,["products","loadingItem"])},methods:{...M(u,["getProducts","getProductDetail","addToCart"])},mounted(){this.getProducts()}},at={class:"container"},dt=t("h2",{class:"text-center my-3"},"所有產品",-1),it={class:"table align-middle"},nt=t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"商品名稱"),t("th",null,"價格"),t("th")])],-1),lt={style:{width:"200px"}},rt={key:0,class:"h5"},ct={key:1},ut={class:"h6"},ht={class:"h5"},pt={class:"btn-group btn-group-sm"},mt=["onClick","disable"],_t={class:"fas fa-spinner fa-pulse"},gt=["onClick","disable"],bt={class:"fas fa-spinner fa-pulse"};function ft(o,s,l,h,r,C){const c=b("ProductModal"),I=b("TheLoading");return i(),n(f,null,[t("section",at,[dt,t("table",it,[nt,t("tbody",null,[(i(!0),n(f,null,A(o.products,e=>(i(),n("tr",{key:e.id},[t("td",lt,[t("div",{style:D([{backgroundImage:`url(${e.imageUrl})`},{"background-position":"center","background-size":"cover",height:"100px"}])},null,4)]),t("td",null,a(e.title),1),t("td",null,[e.price===e.origin_price?(i(),n("div",rt,a(e.price)+" 元 ",1)):(i(),n("div",ct,[t("del",ut,"原價 "+a(e.origin_price)+" 元",1),t("div",ht,"現在只要 "+a(e.price)+" 元",1)]))]),t("td",null,[t("div",pt,[t("button",{onClick:S=>o.getProductDetail(this.$refs.productModal,e.id),disable:o.loadingItem===e.id,class:"btn btn-outline-secondary",type:"button"},[g(t("i",_t,null,512),[[v,o.loadingItem===e.id]]),y(" 查看更多 ")],8,mt),t("button",{onClick:S=>o.addToCart(e.id),disable:o.loadingItem===e.id,class:"btn btn-outline-danger",type:"button"},[g(t("i",bt,null,512),[[v,o.loadingItem===e.id]]),y(" 加到購物車 ")],8,gt)])])]))),128))])])]),$(c,{ref:"productModal",onAddToCart:o.addToCart},null,8,["onAddToCart"]),$(I)],64)}const Mt=k(et,[["render",ft]]);export{Mt as default};
