import{d as w,a as p,m as P,b as c,_ as T,o as a,c as i,e as t,t as d,w as g,v as S,r as b,F as $,f as A,g as f,n as V,h as v,i as y}from"./index-36529d55.js";import{M as D}from"./modal-4d9cea6b.js";import{S as E}from"./sweetalert2.all-d64b939e.js";import{u as k,T as L}from"./TheLoading-93860078.js";const{VITE_API:m,VITE_API_PATH:_}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_API_PATH:"benson-vue3",BASE_URL:"/Vue3-training-2022-Winter/Week6/dist/",MODE:"production",DEV:!1,PROD:!0},u=w("useProductStore",{state:()=>({modal:{},isShow:!1,products:[],product:{},loadingItem:""}),actions:{getProducts(){const o=`${m}/api/${_}/products/all`;p.get(o).then(s=>{this.products=s.data.products}).catch(s=>{alert(s)})},getProductDetail(o,s){this.getProduct(s),this.modal=o,this.isShow=!0,this.modal.openModal()},addToCart(o,s=1){const n=`${m}/api/${_}/cart`,h={product_id:o,qty:s};this.loadingItem=o,p.post(n,{data:h}).then(()=>{E.fire({position:"top-end",icon:"success",title:"已加入購物車",showConfirmButton:!1,timer:1500}),this.isShow&&(this.modal.closeModal(),this.isShow=!1)}).catch(l=>{alert(l)})},getProduct(o){const s=`${m}/api/${_}/product/${o}`;p.get(s).then(n=>{this.product=n.data.product})}}}),q={data(){return{modal:{},qty:1}},mounted(){this.modal=new D(this.$refs.modal)},computed:{...P(u,["product"])},methods:{...c(u,["addToCart"]),...c(k,["doAjax"]),openModal(){this.modal.show(),this.qty=1,this.doAjax(1e3)},closeModal(){this.modal.hide(),this.qty=1}}},B={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},j={class:"modal-dialog modal-xl",role:"document"},U={class:"modal-content border-0"},N={class:"modal-header bg-dark text-white"},z={class:"modal-title",id:"exampleModalLabel"},F=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),H={class:"modal-body"},O={class:"row"},R={class:"col-sm-6"},W=["src","alt"],G={class:"col-sm-6"},J={class:"badge bg-primary rounded-pill"},K={key:0,class:"h5"},Q={key:1},X={class:"h6"},Y={class:"h5"},Z={class:"input-group"};function x(o,s,n,h,l,C){return a(),i("div",B,[t("div",j,[t("div",U,[t("div",N,[t("h5",z,[t("span",null,d(o.product.title),1)]),F]),t("div",H,[t("div",O,[t("div",R,[t("img",{class:"img-fluid",src:o.product.imageUrl,alt:o.product.title},null,8,W)]),t("div",G,[t("span",J,d(o.product.category),1),t("p",null,"商品描述："+d(o.product.description),1),t("p",null,"商品內容："+d(o.product.content),1),o.product.price===o.product.origin_price?(a(),i("div",K,d(o.product.price)+" 元 ",1)):(a(),i("div",Q,[t("del",X,"原價 "+d(o.product.origin_price)+" 元",1),t("h5",Y,"現在只要 "+d(o.product.price)+" 元",1)])),t("div",null,[t("div",Z,[g(t("input",{type:"number",class:"form-control",min:"1","onUpdate:modelValue":s[0]||(s[0]=r=>l.qty=r)},null,512),[[S,l.qty,void 0,{number:!0}]]),t("button",{type:"button",class:"btn btn-primary",onClick:s[1]||(s[1]=r=>o.addToCart(o.product.id))}," 加入購物車 ")])])])])])])])],512)}const tt=T(q,[["render",x]]),ot={components:{ProductModal:tt,TheLoading:L},computed:{...P(u,["products","loadingItem"])},methods:{...c(u,["getProducts","getProductDetail","addToCart"]),...c(k,["doAjax"])},mounted(){this.getProducts(),this.doAjax()}},st={class:"container"},et=t("h2",{class:"text-center my-3"},"所有產品",-1),dt={class:"table align-middle"},at=t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"商品名稱"),t("th",null,"價格"),t("th")])],-1),it={style:{width:"200px"}},nt={key:0,class:"h5"},lt={key:1},rt={class:"h6"},ct={class:"h5"},ut={class:"btn-group btn-group-sm"},ht=["onClick","disable"],pt={class:"fas fa-spinner fa-pulse"},mt=["onClick","disable"],_t={class:"fas fa-spinner fa-pulse"};function gt(o,s,n,h,l,C){const r=b("ProductModal"),I=b("TheLoading");return a(),i($,null,[t("section",st,[et,t("table",dt,[at,t("tbody",null,[(a(!0),i($,null,A(o.products,e=>(a(),i("tr",{key:e.id},[t("td",it,[t("div",{style:V([{backgroundImage:`url(${e.imageUrl})`},{"background-position":"center","background-size":"cover",height:"100px"}])},null,4)]),t("td",null,d(e.title),1),t("td",null,[e.price===e.origin_price?(a(),i("div",nt,d(e.price)+" 元 ",1)):(a(),i("div",lt,[t("del",rt,"原價 "+d(e.origin_price)+" 元",1),t("div",ct,"現在只要 "+d(e.price)+" 元",1)]))]),t("td",null,[t("div",ut,[t("button",{onClick:M=>o.getProductDetail(this.$refs.productModal,e.id),disable:o.loadingItem===e.id,class:"btn btn-outline-secondary",type:"button"},[g(t("i",pt,null,512),[[v,o.loadingItem===e.id]]),y(" 查看更多 ")],8,ht),t("button",{onClick:M=>o.addToCart(e.id),disable:o.loadingItem===e.id,class:"btn btn-outline-danger",type:"button"},[g(t("i",_t,null,512),[[v,o.loadingItem===e.id]]),y(" 加到購物車 ")],8,mt)])])]))),128))])])]),f(r,{ref:"productModal",onAddToCart:o.addToCart},null,8,["onAddToCart"]),f(I)],64)}const yt=T(ot,[["render",gt]]);export{yt as default};
