import{d as I,a as h,m as v,b as f,_ as y,o as a,c as i,e as t,t as d,w as _,v as M,r as T,F as g,f as C,g as w,n as S,h as b,i as $}from"./index-f9f93841.js";import{M as V}from"./modal-c60aad6a.js";const{VITE_API:p,VITE_API_PATH:m}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_API_PATH:"benson-vue3",BASE_URL:"/Vue3-training-2022-Winter/Week6/dist/",MODE:"production",DEV:!1,PROD:!0},c=I("useProductStore",{state:()=>({modal:{},isShow:!1,products:[],product:{},loadingItem:""}),actions:{getProducts(){const o=`${p}/api/${m}/products/all`;h.get(o).then(s=>{this.products=s.data.products}).catch(s=>{alert(s)})},getProductDetail(o,s){this.getProduct(s),this.modal=o,this.isShow=!0,this.modal.openModal()},addToCart(o,s=1){const n=`${p}/api/${m}/cart`,u={product_id:o,qty:s};this.loadingItem=o,h.post(n,{data:u}).then(l=>{alert(l.data.message),this.loadingItem="",this.isShow&&(this.modal.closeModal(),this.isShow=!1)}).catch(l=>{alert(l)})},getProduct(o){const s=`${p}/api/${m}/product/${o}`;h.get(s).then(n=>{this.product=n.data.product})}}}),A={data(){return{modal:{},qty:1}},mounted(){this.modal=new V(this.$refs.modal)},computed:{...v(c,["product"])},methods:{...f(c,["addToCart"]),openModal(){this.modal.show(),this.qty=1},closeModal(){this.modal.hide(),this.qty=1}}},D={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},E={class:"modal-dialog modal-xl",role:"document"},q={class:"modal-content border-0"},B={class:"modal-header bg-dark text-white"},L={class:"modal-title",id:"exampleModalLabel"},U=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),N={class:"modal-body"},z={class:"row"},F={class:"col-sm-6"},H=["src","alt"],O={class:"col-sm-6"},R={class:"badge bg-primary rounded-pill"},W={key:0,class:"h5"},j={key:1},G={class:"h6"},J={class:"h5"},K={class:"input-group"};function Q(o,s,n,u,l,P){return a(),i("div",D,[t("div",E,[t("div",q,[t("div",B,[t("h5",L,[t("span",null,d(o.product.title),1)]),U]),t("div",N,[t("div",z,[t("div",F,[t("img",{class:"img-fluid",src:o.product.imageUrl,alt:o.product.title},null,8,H)]),t("div",O,[t("span",R,d(o.product.category),1),t("p",null,"商品描述："+d(o.product.description),1),t("p",null,"商品內容："+d(o.product.content),1),o.product.price===o.product.origin_price?(a(),i("div",W,d(o.product.price)+" 元 ",1)):(a(),i("div",j,[t("del",G,"原價 "+d(o.product.origin_price)+" 元",1),t("h5",J,"現在只要 "+d(o.product.price)+" 元",1)])),t("div",null,[t("div",K,[_(t("input",{type:"number",class:"form-control",min:"1","onUpdate:modelValue":s[0]||(s[0]=r=>l.qty=r)},null,512),[[M,l.qty,void 0,{number:!0}]]),t("button",{type:"button",class:"btn btn-primary",onClick:s[1]||(s[1]=r=>o.addToCart(o.product.id))}," 加入購物車 ")])])])])])])])],512)}const X=y(A,[["render",Q]]),Y={components:{ProductModal:X},computed:{...v(c,["products","loadingItem"])},methods:{...f(c,["getProducts","getProductDetail","addToCart"])},mounted(){this.getProducts()}},Z={class:"container"},x=t("h2",{class:"text-center my-3"},"所有產品",-1),tt={class:"table align-middle"},ot=t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"商品名稱"),t("th",null,"價格"),t("th")])],-1),st={style:{width:"200px"}},et={key:0,class:"h5"},dt={key:1},at={class:"h6"},it={class:"h5"},lt={class:"btn-group btn-group-sm"},nt=["onClick","disable"],rt={class:"fas fa-spinner fa-pulse"},ct=["onClick","disable"],ut={class:"fas fa-spinner fa-pulse"};function ht(o,s,n,u,l,P){const r=T("ProductModal");return a(),i(g,null,[t("section",Z,[x,t("table",tt,[ot,t("tbody",null,[(a(!0),i(g,null,C(o.products,e=>(a(),i("tr",{key:e.id},[t("td",st,[t("div",{style:S([{backgroundImage:`url(${e.imageUrl})`},{"background-position":"center","background-size":"cover",height:"100px"}])},null,4)]),t("td",null,d(e.title),1),t("td",null,[e.price===e.origin_price?(a(),i("div",et,d(e.price)+" 元 ",1)):(a(),i("div",dt,[t("del",at,"原價 "+d(e.origin_price)+" 元",1),t("div",it,"現在只要 "+d(e.price)+" 元",1)]))]),t("td",null,[t("div",lt,[t("button",{onClick:k=>o.getProductDetail(this.$refs.productModal,e.id),disable:o.loadingItem===e.id,class:"btn btn-outline-secondary",type:"button"},[_(t("i",rt,null,512),[[b,o.loadingItem===e.id]]),$(" 查看更多 ")],8,nt),t("button",{onClick:k=>o.addToCart(e.id),disable:o.loadingItem===e.id,class:"btn btn-outline-danger",type:"button"},[_(t("i",ut,null,512),[[b,o.loadingItem===e.id]]),$(" 加到購物車 ")],8,ct)])])]))),128))])])]),w(r,{ref:"productModal",onAddToCart:o.addToCart},null,8,["onAddToCart"])],64)}const _t=y(Y,[["render",ht]]);export{_t as default};
