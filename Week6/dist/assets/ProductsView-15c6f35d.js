import{d as w,a as p,m as P,b as T,_ as k,o as i,c as l,e as t,t as d,w as g,v as I,r as b,F as f,f as V,g as $,n as A,h as v,i as y}from"./index-a232e2f3.js";import{M as D,T as E}from"./TheLoading-a7d044d4.js";import{S as L}from"./sweetalert2.all-32a2f653.js";import{u as q}from"./useLoadingStore-f2bb9720.js";const{VITE_API:m,VITE_API_PATH:_}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_API_PATH:"benson-vue3",BASE_URL:"/Vue3-training-2022-Winter/Week6/dist/",MODE:"production",DEV:!1,PROD:!0},{loadingState:a}=q(),u=w("useProductStore",{state:()=>({modal:{},isShow:!1,products:[],product:{},loadingItem:""}),actions:{getProducts(){const o=`${m}/api/${_}/products/all`;a(!0),p.get(o).then(s=>{this.products=s.data.products,a(!1)}).catch(s=>{alert(s),a(!1)})},getProductDetail(o,s){this.getProduct(s),this.modal=o,this.isShow=!0,this.modal.openModal()},addToCart(o,s=1){const n=`${m}/api/${_}/cart`,h={product_id:o,qty:s};a(!0),p.post(n,{data:h}).then(()=>{a(!1),L.fire({position:"top-end",icon:"success",title:"已加入購物車",showConfirmButton:!1,timer:1500}),this.isShow&&(this.modal.closeModal(),this.isShow=!1,a(!1))}).catch(r=>{alert(r)})},getProduct(o){const s=`${m}/api/${_}/product/${o}`;a(!0),this.product={},p.get(s).then(n=>{this.product=n.data.product,a(!1)})}}}),B={data(){return{modal:{},qty:1}},mounted(){this.modal=new D(this.$refs.modal)},computed:{...P(u,["product"])},methods:{...T(u,["addToCart"]),openModal(){this.modal.show(),this.qty=1},closeModal(){this.modal.hide(),this.qty=1}}},U={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},N={class:"modal-dialog modal-xl",role:"document"},z={class:"modal-content border-0"},F={class:"modal-header bg-dark text-white"},H={class:"modal-title",id:"exampleModalLabel"},O=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),R={class:"modal-body"},W={class:"row"},j={class:"col-sm-6"},G=["src","alt"],J={class:"col-sm-6"},K={class:"badge bg-primary rounded-pill"},Q={key:0,class:"h5"},X={key:1},Y={class:"h6"},Z={class:"h5"},x={class:"input-group"};function tt(o,s,n,h,r,C){return i(),l("div",U,[t("div",N,[t("div",z,[t("div",F,[t("h5",H,[t("span",null,d(o.product.title),1)]),O]),t("div",R,[t("div",W,[t("div",j,[t("img",{class:"img-fluid",src:o.product.imageUrl,alt:o.product.title},null,8,G)]),t("div",J,[t("span",K,d(o.product.category),1),t("p",null,"商品描述："+d(o.product.description),1),t("p",null,"商品內容："+d(o.product.content),1),o.product.price===o.product.origin_price?(i(),l("div",Q,d(o.product.price)+" 元 ",1)):(i(),l("div",X,[t("del",Y,"原價 "+d(o.product.origin_price)+" 元",1),t("h5",Z,"現在只要 "+d(o.product.price)+" 元",1)])),t("div",null,[t("div",x,[g(t("input",{type:"number",class:"form-control",min:"1","onUpdate:modelValue":s[0]||(s[0]=c=>r.qty=c)},null,512),[[I,r.qty,void 0,{number:!0}]]),t("button",{type:"button",class:"btn btn-primary",onClick:s[1]||(s[1]=c=>o.addToCart(o.product.id))}," 加入購物車 ")])])])])])])])],512)}const ot=k(B,[["render",tt]]),st={components:{ProductModal:ot,TheLoading:E},computed:{...P(u,["products","loadingItem"])},methods:{...T(u,["getProducts","getProductDetail","addToCart"])},mounted(){this.getProducts()}},et={class:"container"},dt=t("h2",{class:"text-center my-3"},"所有產品",-1),at={class:"table align-middle"},it=t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"商品名稱"),t("th",null,"價格"),t("th")])],-1),lt={style:{width:"200px"}},nt={key:0,class:"h5"},rt={key:1},ct={class:"h6"},ut={class:"h5"},ht={class:"btn-group btn-group-sm"},pt=["onClick","disable"],mt={class:"fas fa-spinner fa-pulse"},_t=["onClick","disable"],gt={class:"fas fa-spinner fa-pulse"};function bt(o,s,n,h,r,C){const c=b("ProductModal"),M=b("TheLoading");return i(),l(f,null,[t("section",et,[dt,t("table",at,[it,t("tbody",null,[(i(!0),l(f,null,V(o.products,e=>(i(),l("tr",{key:e.id},[t("td",lt,[t("div",{style:A([{backgroundImage:`url(${e.imageUrl})`},{"background-position":"center","background-size":"cover",height:"100px"}])},null,4)]),t("td",null,d(e.title),1),t("td",null,[e.price===e.origin_price?(i(),l("div",nt,d(e.price)+" 元 ",1)):(i(),l("div",rt,[t("del",ct,"原價 "+d(e.origin_price)+" 元",1),t("div",ut,"現在只要 "+d(e.price)+" 元",1)]))]),t("td",null,[t("div",ht,[t("button",{onClick:S=>o.getProductDetail(this.$refs.productModal,e.id),disable:o.loadingItem===e.id,class:"btn btn-outline-secondary",type:"button"},[g(t("i",mt,null,512),[[v,o.loadingItem===e.id]]),y(" 查看更多 ")],8,pt),t("button",{onClick:S=>o.addToCart(e.id),disable:o.loadingItem===e.id,class:"btn btn-outline-danger",type:"button"},[g(t("i",gt,null,512),[[v,o.loadingItem===e.id]]),y(" 加到購物車 ")],8,_t)])])]))),128))])])]),$(c,{ref:"productModal",onAddToCart:o.addToCart},null,8,["onAddToCart"]),$(M)],64)}const Pt=k(st,[["render",bt]]);export{Pt as default};
